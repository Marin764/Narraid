2025-04-24 00:00:59,586 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:01:00,231 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:01:00,231 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:01:00,239 - INFO - _internal.py:225 -  * Running on http://127.0.0.1:5001/ (Press CTRL+C to quit)
2025-04-24 00:01:00,240 - INFO - _internal.py:225 -  * Restarting with stat
2025-04-24 00:01:01,529 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:01:02,087 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:01:02,087 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:01:02,091 - WARNING - _internal.py:225 -  * Debugger is active!
2025-04-24 00:01:02,111 - INFO - _internal.py:225 -  * Debugger PIN: 135-921-718
2025-04-24 00:01:13,266 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:01:13] "GET / HTTP/1.1" 200 -
2025-04-24 00:01:18,475 - INFO - app.py:194 - 开始处理上传的文件...
2025-04-24 00:01:18,478 - INFO - app.py:197 - 创建临时文件: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmpiq7tmbl8.wav
2025-04-24 00:01:18,478 - INFO - app.py:199 - 文件保存成功
2025-04-24 00:01:18,478 - INFO - app.py:202 - 开始转换音频格式...
2025-04-24 00:01:18,628 - DEBUG - logging_utils.py:9 - subprocess.call(['ffmpeg', '-y', '-i', '/var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmpiq7tmbl8.wav', '-acodec', 'pcm_s32le', '-vn', '-f', 'wav', '-'])
2025-04-24 00:01:18,681 - INFO - app.py:204 - 原始音频信息: 通道数=1, 采样率=48000, 时长=3.54秒
2025-04-24 00:01:18,684 - INFO - app.py:208 - 转换后音频信息: 通道数=1, 采样率=16000
2025-04-24 00:01:18,684 - INFO - app.py:211 - 音频格式转换完成
2025-04-24 00:01:18,684 - INFO - app.py:214 - 开始加载音频数据...
2025-04-24 00:01:18,729 - INFO - app.py:218 - 音频数据加载成功，形状: (56640,), 类型: float32
2025-04-24 00:01:18,729 - INFO - app.py:225 - 处理后的音频数据形状: torch.Size([56640]), 类型: torch.float32
2025-04-24 00:01:18,729 - INFO - app.py:228 - 开始转录...
2025-04-24 00:01:18,729 - INFO - app.py:229 - 设置转录参数...
2025-04-24 00:01:18,729 - INFO - app.py:238 - 转录参数: {"language": "zh", "task": "transcribe", "vad": true, "trust_whisper_timestamps": false, "refine_whisper_precision": 0.02, "plot_word_alignment": false}
2025-04-24 00:01:18,729 - INFO - app.py:241 - 开始执行转录...
2025-04-24 00:01:18,746 - WARNING - transcribe.py:1852 - Please install onnxruntime to use more efficiently silero VAD
2025-04-24 00:01:19,487 - ERROR - app.py:293 - 转录过程中出现错误: 'NoneType' object has no attribute 'shape'
2025-04-24 00:01:19,496 - ERROR - app.py:294 - Traceback (most recent call last):
  File "/Users/regulusemilia/Desktop/narraid/app.py", line 242, in upload_file
    result = transcribe_timestamped(model, audio_data, **transcribe_options)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 284, in transcribe_timestamped
    (transcription, words) = _transcribe_timestamped_efficient(model, audio,
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 873, in _transcribe_timestamped_efficient
    transcription = model.transcribe(audio, **whisper_options)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/transcribe.py", line 279, in transcribe
    result: DecodingResult = decode_with_fallback(mel_segment)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/transcribe.py", line 195, in decode_with_fallback
    decode_result = model.decode(segment, options)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 824, in decode
    result = DecodingTask(model, options).run(mel)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 737, in run
    tokens, sum_logprobs, no_speech_probs = self._main_loop(audio_features, tokens)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 687, in _main_loop
    logits = self.inference.logits(tokens, audio_features)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 163, in logits
    return self.model.decoder(tokens, audio_features, kv_cache=self.kv_cache)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/model.py", line 242, in forward
    x = block(x, xa, mask=self.mask, kv_cache=kv_cache)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/model.py", line 169, in forward
    x = x + self.cross_attn(self.cross_attn_ln(x), xa, kv_cache=kv_cache)[0]
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1806, in inner
    hook_result = hook(self, args, result)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 867, in <lambda>
    lambda layer, ins, outs, index=j: hook_attention_weights(layer, ins, outs, index))
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 762, in hook_attention_weights
    if w.shape[-2] > 1:
AttributeError: 'NoneType' object has no attribute 'shape'

2025-04-24 00:01:19,497 - INFO - app.py:305 - 临时文件已删除: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmpiq7tmbl8.wav
2025-04-24 00:01:19,497 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:01:19] "[35m[1mPOST /upload HTTP/1.1[0m" 500 -
2025-04-24 00:02:39,759 - INFO - _internal.py:225 -  * Detected change in '/Users/regulusemilia/Desktop/narraid/app.py', reloading
2025-04-24 00:02:40,026 - INFO - _internal.py:225 -  * Restarting with stat
2025-04-24 00:02:41,415 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:02:42,134 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:02:42,134 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:02:42,142 - WARNING - _internal.py:225 -  * Debugger is active!
2025-04-24 00:02:42,156 - INFO - _internal.py:225 -  * Debugger PIN: 135-921-718
2025-04-24 00:03:40,952 - INFO - _internal.py:225 -  * Detected change in '/Users/regulusemilia/Desktop/narraid/app.py', reloading
2025-04-24 00:03:41,256 - INFO - _internal.py:225 -  * Restarting with stat
2025-04-24 00:03:42,734 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:03:44,105 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:03:44,647 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:03:44,647 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:03:44,656 - INFO - _internal.py:225 -  * Running on http://127.0.0.1:5001/ (Press CTRL+C to quit)
2025-04-24 00:03:44,657 - INFO - _internal.py:225 -  * Restarting with stat
2025-04-24 00:03:45,936 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:03:46,505 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:03:46,505 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:03:46,509 - WARNING - _internal.py:225 -  * Debugger is active!
2025-04-24 00:03:46,528 - INFO - _internal.py:225 -  * Debugger PIN: 135-921-718
2025-04-24 00:03:51,418 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:03:51] "GET / HTTP/1.1" 200 -
2025-04-24 00:03:56,245 - INFO - app.py:291 - 开始处理上传的文件...
2025-04-24 00:03:56,248 - INFO - app.py:294 - 创建临时文件: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmpuuyf5475.wav
2025-04-24 00:03:56,248 - INFO - app.py:296 - 文件保存成功
2025-04-24 00:03:56,248 - INFO - app.py:299 - 开始转换音频格式...
2025-04-24 00:03:56,408 - DEBUG - logging_utils.py:9 - subprocess.call(['ffmpeg', '-y', '-i', '/var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmpuuyf5475.wav', '-acodec', 'pcm_s32le', '-vn', '-f', 'wav', '-'])
2025-04-24 00:03:56,460 - INFO - app.py:301 - 原始音频信息: 通道数=1, 采样率=48000, 时长=3.78秒
2025-04-24 00:03:56,462 - INFO - app.py:305 - 转换后音频信息: 通道数=1, 采样率=16000
2025-04-24 00:03:56,463 - INFO - app.py:308 - 音频格式转换完成
2025-04-24 00:03:56,463 - INFO - app.py:311 - 开始加载音频数据...
2025-04-24 00:03:56,505 - INFO - app.py:315 - 音频数据加载成功，形状: (60480,), 类型: float32
2025-04-24 00:03:56,505 - INFO - app.py:322 - 处理后的音频数据形状: torch.Size([60480]), 类型: torch.float32
2025-04-24 00:03:56,505 - INFO - app.py:325 - 开始转录...
2025-04-24 00:03:56,505 - INFO - app.py:326 - 设置转录参数...
2025-04-24 00:03:56,505 - INFO - app.py:335 - 转录参数: {"language": "zh", "task": "transcribe", "vad": true, "trust_whisper_timestamps": false, "refine_whisper_precision": 0.02, "plot_word_alignment": false}
2025-04-24 00:03:56,505 - INFO - app.py:338 - 开始执行转录...
2025-04-24 00:03:56,521 - WARNING - transcribe.py:1852 - Please install onnxruntime to use more efficiently silero VAD
2025-04-24 00:03:57,355 - ERROR - app.py:390 - 转录过程中出现错误: 'NoneType' object has no attribute 'shape'
2025-04-24 00:03:57,364 - ERROR - app.py:391 - Traceback (most recent call last):
  File "/Users/regulusemilia/Desktop/narraid/app.py", line 339, in upload_file
    result = transcribe_timestamped(model, audio_data, **transcribe_options)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 284, in transcribe_timestamped
    (transcription, words) = _transcribe_timestamped_efficient(model, audio,
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 873, in _transcribe_timestamped_efficient
    transcription = model.transcribe(audio, **whisper_options)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/transcribe.py", line 279, in transcribe
    result: DecodingResult = decode_with_fallback(mel_segment)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/transcribe.py", line 195, in decode_with_fallback
    decode_result = model.decode(segment, options)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 824, in decode
    result = DecodingTask(model, options).run(mel)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 737, in run
    tokens, sum_logprobs, no_speech_probs = self._main_loop(audio_features, tokens)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 687, in _main_loop
    logits = self.inference.logits(tokens, audio_features)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/decoding.py", line 163, in logits
    return self.model.decoder(tokens, audio_features, kv_cache=self.kv_cache)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/model.py", line 242, in forward
    x = block(x, xa, mask=self.mask, kv_cache=kv_cache)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper/model.py", line 169, in forward
    x = x + self.cross_attn(self.cross_attn_ln(x), xa, kv_cache=kv_cache)[0]
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1845, in _call_impl
    return inner()
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/torch/nn/modules/module.py", line 1806, in inner
    hook_result = hook(self, args, result)
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 867, in <lambda>
    lambda layer, ins, outs, index=j: hook_attention_weights(layer, ins, outs, index))
  File "/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/transcribe.py", line 762, in hook_attention_weights
    if w.shape[-2] > 1:
AttributeError: 'NoneType' object has no attribute 'shape'

2025-04-24 00:03:57,365 - INFO - app.py:402 - 临时文件已删除: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmpuuyf5475.wav
2025-04-24 00:03:57,365 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:03:57] "[35m[1mPOST /upload HTTP/1.1[0m" 500 -
2025-04-24 00:07:31,399 - INFO - _internal.py:225 -  * Detected change in '/Users/regulusemilia/Library/Python/3.9/lib/python/site-packages/whisper_timestamped/__init__.py', reloading
2025-04-24 00:07:31,658 - INFO - _internal.py:225 -  * Restarting with stat
2025-04-24 00:07:33,072 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:07:33,682 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:07:33,682 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:07:33,688 - WARNING - _internal.py:225 -  * Debugger is active!
2025-04-24 00:07:33,707 - INFO - _internal.py:225 -  * Debugger PIN: 135-921-718
2025-04-24 00:08:00,907 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:08:01,558 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:08:01,559 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:08:01,567 - INFO - _internal.py:225 -  * Running on http://127.0.0.1:5001/ (Press CTRL+C to quit)
2025-04-24 00:08:01,568 - INFO - _internal.py:225 -  * Restarting with stat
2025-04-24 00:08:02,801 - INFO - app.py:65 - 正在加载模型...
2025-04-24 00:08:03,445 - INFO - app.py:70 - 模型类型: <class 'whisper.model.Whisper'>
2025-04-24 00:08:03,445 - INFO - app.py:71 - 模型加载成功！
2025-04-24 00:08:03,449 - WARNING - _internal.py:225 -  * Debugger is active!
2025-04-24 00:08:03,469 - INFO - _internal.py:225 -  * Debugger PIN: 135-921-718
2025-04-24 00:08:09,380 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:08:09] "GET / HTTP/1.1" 200 -
2025-04-24 00:08:15,865 - INFO - app.py:291 - 开始处理上传的文件...
2025-04-24 00:08:15,867 - INFO - app.py:294 - 创建临时文件: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmps_0mkaad.wav
2025-04-24 00:08:15,867 - INFO - app.py:296 - 文件保存成功
2025-04-24 00:08:15,867 - INFO - app.py:299 - 开始转换音频格式...
2025-04-24 00:08:16,009 - DEBUG - logging_utils.py:9 - subprocess.call(['ffmpeg', '-y', '-i', '/var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmps_0mkaad.wav', '-acodec', 'pcm_s32le', '-vn', '-f', 'wav', '-'])
2025-04-24 00:08:16,065 - INFO - app.py:301 - 原始音频信息: 通道数=1, 采样率=48000, 时长=5.22秒
2025-04-24 00:08:16,068 - INFO - app.py:305 - 转换后音频信息: 通道数=1, 采样率=16000
2025-04-24 00:08:16,068 - INFO - app.py:308 - 音频格式转换完成
2025-04-24 00:08:16,068 - INFO - app.py:311 - 开始加载音频数据...
2025-04-24 00:08:16,114 - INFO - app.py:315 - 音频数据加载成功，形状: (83520,), 类型: float32
2025-04-24 00:08:16,114 - INFO - app.py:322 - 处理后的音频数据形状: torch.Size([83520]), 类型: torch.float32
2025-04-24 00:08:16,114 - INFO - app.py:325 - 开始转录...
2025-04-24 00:08:16,114 - INFO - app.py:326 - 设置转录参数...
2025-04-24 00:08:16,114 - INFO - app.py:335 - 转录参数: {"language": "zh", "task": "transcribe", "vad": true, "trust_whisper_timestamps": false, "refine_whisper_precision": 0.02, "plot_word_alignment": false}
2025-04-24 00:08:16,114 - INFO - app.py:338 - 开始执行转录...
2025-04-24 00:08:16,129 - WARNING - transcribe.py:1965 - Please install onnxruntime to use more efficiently silero VAD
2025-04-24 00:08:17,224 - DEBUG - transcribe.py:701 - Add segment 1:
	<|0.00|>這是一句流唱的話<|3.00|>
2025-04-24 00:08:17,224 - DEBUG - transcribe.py:938 - Compile results
2025-04-24 00:08:17,225 - INFO - app.py:344 - 转录完成，结果: {
  "text": "這是一句流唱的話",
  "segments": [
    {
      "id": 0,
      "seek": 0,
      "start": 0.67,
      "end": 2.49,
      "text": "這是一句流唱的話",
      "tokens": [
        50364,
        16600,
        2257,
        34592,
        27854,
        39861,
        21358,
        50514
      ],
      "temperature": 0.0,
      "avg_logprob": -0.7167912589179145,
      "compression_ratio": 0.6857142857142857,
      "no_speech_prob": 0.05413474142551422,
      "confidence": 0.631,
      "words": [
        {
          "text": "這是",
          "start": 0.67,
          "end": 0.97,
          "confidence": 0.442
        },
        {
          "text": "一",
          "start": 0.97,
          "end": 1.33,
          "confidence": 0.959
        },
        {
          "text": "句",
          "start": 1.33,
          "end": 1.53,
          "confidence": 0.855
        },
        {
          "text": "流",
          "start": 1.53,
          "end": 1.79,
          "confidence": 0.595
        },
        {
          "text": "唱",
          "start": 1.79,
          "end": 2.09,
          "confidence": 0.398
        },
        {
          "text": "的話",
          "start": 2.09,
          "end": 2.49,
          "confidence": 0.733
        }
      ]
    }
  ],
  "language": "zh",
  "speech_activity": [
    {
      "start": 0.206,
      "end": 3.698
    }
  ]
}
2025-04-24 00:08:17,225 - INFO - app.py:347 - 开始处理转录结果...
2025-04-24 00:08:17,225 - INFO - app.py:350 - 处理段落: 這是一句流唱的話
2025-04-24 00:08:17,225 - DEBUG - app.py:353 - 处理单词: 這是
2025-04-24 00:08:17,225 - DEBUG - app.py:367 - 单词 這是 到 一 的间隔: 0.000秒
2025-04-24 00:08:17,225 - DEBUG - app.py:353 - 处理单词: 一
2025-04-24 00:08:17,225 - DEBUG - app.py:367 - 单词 一 到 句 的间隔: 0.000秒
2025-04-24 00:08:17,225 - DEBUG - app.py:353 - 处理单词: 句
2025-04-24 00:08:17,225 - DEBUG - app.py:367 - 单词 句 到 流 的间隔: 0.000秒
2025-04-24 00:08:17,225 - DEBUG - app.py:353 - 处理单词: 流
2025-04-24 00:08:17,225 - DEBUG - app.py:367 - 单词 流 到 唱 的间隔: 0.000秒
2025-04-24 00:08:17,225 - DEBUG - app.py:353 - 处理单词: 唱
2025-04-24 00:08:17,225 - DEBUG - app.py:367 - 单词 唱 到 的話 的间隔: 0.000秒
2025-04-24 00:08:17,225 - DEBUG - app.py:353 - 处理单词: 的話
2025-04-24 00:08:17,225 - INFO - app.py:380 - 开始分析间隔...
2025-04-24 00:08:17,225 - INFO - app.py:161 - 开始分析间隔...
2025-04-24 00:08:17,225 - INFO - app.py:165 - 处理段落 1/1: 這是一句流唱的話
2025-04-24 00:08:17,225 - DEBUG - app.py:171 - 段落 1 包含 6 个词
2025-04-24 00:08:17,225 - DEBUG - app.py:178 - 拆分后的字符: ['這', '是', '一', '句', '流', '唱', '的', '話']
2025-04-24 00:08:17,225 - DEBUG - app.py:182 - 处理字符 1/8: 這
2025-04-24 00:08:17,225 - DEBUG - app.py:192 - 找到包含字符 '這' 的词: 這是
2025-04-24 00:08:17,225 - DEBUG - app.py:196 - 字符位置: 1/2
2025-04-24 00:08:17,225 - DEBUG - app.py:207 - 字符时间: 开始=0.670s, 结束=0.820s
2025-04-24 00:08:17,225 - DEBUG - app.py:226 - 找到下一个字符 '是' 的词: 這是
2025-04-24 00:08:17,225 - DEBUG - app.py:239 - 字符 '這' 到 '是' 的间隔: 0.000秒
2025-04-24 00:08:17,225 - DEBUG - app.py:182 - 处理字符 2/8: 是
2025-04-24 00:08:17,225 - DEBUG - app.py:192 - 找到包含字符 '是' 的词: 這是
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 2/2
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=0.820s, 结束=0.970s
2025-04-24 00:08:17,226 - DEBUG - app.py:226 - 找到下一个字符 '一' 的词: 一
2025-04-24 00:08:17,226 - DEBUG - app.py:239 - 字符 '是' 到 '一' 的间隔: 0.000秒
2025-04-24 00:08:17,226 - DEBUG - app.py:182 - 处理字符 3/8: 一
2025-04-24 00:08:17,226 - DEBUG - app.py:192 - 找到包含字符 '一' 的词: 一
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=0.970s, 结束=1.330s
2025-04-24 00:08:17,226 - DEBUG - app.py:226 - 找到下一个字符 '句' 的词: 句
2025-04-24 00:08:17,226 - DEBUG - app.py:239 - 字符 '一' 到 '句' 的间隔: 0.000秒
2025-04-24 00:08:17,226 - DEBUG - app.py:182 - 处理字符 4/8: 句
2025-04-24 00:08:17,226 - DEBUG - app.py:192 - 找到包含字符 '句' 的词: 句
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=1.330s, 结束=1.530s
2025-04-24 00:08:17,226 - DEBUG - app.py:226 - 找到下一个字符 '流' 的词: 流
2025-04-24 00:08:17,226 - DEBUG - app.py:239 - 字符 '句' 到 '流' 的间隔: 0.000秒
2025-04-24 00:08:17,226 - DEBUG - app.py:182 - 处理字符 5/8: 流
2025-04-24 00:08:17,226 - DEBUG - app.py:192 - 找到包含字符 '流' 的词: 流
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=1.530s, 结束=1.790s
2025-04-24 00:08:17,226 - DEBUG - app.py:226 - 找到下一个字符 '唱' 的词: 唱
2025-04-24 00:08:17,226 - DEBUG - app.py:239 - 字符 '流' 到 '唱' 的间隔: 0.000秒
2025-04-24 00:08:17,226 - DEBUG - app.py:182 - 处理字符 6/8: 唱
2025-04-24 00:08:17,226 - DEBUG - app.py:192 - 找到包含字符 '唱' 的词: 唱
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=1.790s, 结束=2.090s
2025-04-24 00:08:17,226 - DEBUG - app.py:226 - 找到下一个字符 '的' 的词: 的話
2025-04-24 00:08:17,226 - DEBUG - app.py:239 - 字符 '唱' 到 '的' 的间隔: 0.000秒
2025-04-24 00:08:17,226 - DEBUG - app.py:182 - 处理字符 7/8: 的
2025-04-24 00:08:17,226 - DEBUG - app.py:192 - 找到包含字符 '的' 的词: 的話
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 1/2
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=2.090s, 结束=2.290s
2025-04-24 00:08:17,226 - DEBUG - app.py:226 - 找到下一个字符 '話' 的词: 的話
2025-04-24 00:08:17,226 - DEBUG - app.py:239 - 字符 '的' 到 '話' 的间隔: 0.000秒
2025-04-24 00:08:17,226 - DEBUG - app.py:182 - 处理字符 8/8: 話
2025-04-24 00:08:17,226 - DEBUG - app.py:192 - 找到包含字符 '話' 的词: 的話
2025-04-24 00:08:17,226 - DEBUG - app.py:196 - 字符位置: 2/2
2025-04-24 00:08:17,226 - DEBUG - app.py:207 - 字符时间: 开始=2.290s, 结束=2.490s
2025-04-24 00:08:17,226 - DEBUG - app.py:245 - 最后一个字符 '話' 没有后续间隔
2025-04-24 00:08:17,227 - INFO - app.py:254 - 段落 1 统计: 平均间隔=0.000秒, 标准差=0.000秒
2025-04-24 00:08:17,227 - INFO - app.py:267 - 间隔分析完成
2025-04-24 00:08:17,227 - INFO - app.py:382 - 间隔分析完成，结果: [
  {
    "text": "這是一句流唱的話",
    "avg_interval": 0.0,
    "std_interval": 0.0,
    "word_details": [
      {
        "text": "這",
        "start": 0.67,
        "end": 0.8200000000000001,
        "duration": 0.15000000000000002,
        "interval_to_next": 0.0
      },
      {
        "text": "是",
        "start": 0.8200000000000001,
        "end": 0.97,
        "duration": 0.1499999999999999,
        "interval_to_next": 0.0
      },
      {
        "text": "一",
        "start": 0.97,
        "end": 1.33,
        "duration": 0.3600000000000001,
        "interval_to_next": 0.0
      },
      {
        "text": "句",
        "start": 1.33,
        "end": 1.53,
        "duration": 0.19999999999999996,
        "interval_to_next": 0.0
      },
      {
        "text": "流",
        "start": 1.53,
        "end": 1.79,
        "duration": 0.26,
        "interval_to_next": 0.0
      },
      {
        "text": "唱",
        "start": 1.79,
        "end": 2.09,
        "duration": 0.2999999999999998,
        "interval_to_next": 0.0
      },
      {
        "text": "的",
        "start": 2.09,
        "end": 2.29,
        "duration": 0.20000000000000018,
        "interval_to_next": 0.0
      },
      {
        "text": "話",
        "start": 2.29,
        "end": 2.49,
        "duration": 0.20000000000000018,
        "interval_to_next": 0
      }
    ]
  }
]
2025-04-24 00:08:17,227 - INFO - app.py:402 - 临时文件已删除: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmps_0mkaad.wav
2025-04-24 00:08:17,227 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:08:17] "POST /upload HTTP/1.1" 200 -
2025-04-24 00:08:45,340 - INFO - app.py:291 - 开始处理上传的文件...
2025-04-24 00:08:45,341 - INFO - app.py:294 - 创建临时文件: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmp52aomj_q.wav
2025-04-24 00:08:45,341 - INFO - app.py:296 - 文件保存成功
2025-04-24 00:08:45,342 - INFO - app.py:299 - 开始转换音频格式...
2025-04-24 00:08:45,494 - DEBUG - logging_utils.py:9 - subprocess.call(['ffmpeg', '-y', '-i', '/var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmp52aomj_q.wav', '-acodec', 'pcm_s32le', '-vn', '-f', 'wav', '-'])
2025-04-24 00:08:45,554 - INFO - app.py:301 - 原始音频信息: 通道数=1, 采样率=48000, 时长=6.6秒
2025-04-24 00:08:45,558 - INFO - app.py:305 - 转换后音频信息: 通道数=1, 采样率=16000
2025-04-24 00:08:45,558 - INFO - app.py:308 - 音频格式转换完成
2025-04-24 00:08:45,558 - INFO - app.py:311 - 开始加载音频数据...
2025-04-24 00:08:45,612 - INFO - app.py:315 - 音频数据加载成功，形状: (105600,), 类型: float32
2025-04-24 00:08:45,612 - INFO - app.py:322 - 处理后的音频数据形状: torch.Size([105600]), 类型: torch.float32
2025-04-24 00:08:45,612 - INFO - app.py:325 - 开始转录...
2025-04-24 00:08:45,612 - INFO - app.py:326 - 设置转录参数...
2025-04-24 00:08:45,612 - INFO - app.py:335 - 转录参数: {"language": "zh", "task": "transcribe", "vad": true, "trust_whisper_timestamps": false, "refine_whisper_precision": 0.02, "plot_word_alignment": false}
2025-04-24 00:08:45,612 - INFO - app.py:338 - 开始执行转录...
2025-04-24 00:08:46,380 - DEBUG - transcribe.py:701 - Add segment 1:
	<|0.00|>這句話不夠流程<|5.00|>
2025-04-24 00:08:46,380 - DEBUG - transcribe.py:938 - Compile results
2025-04-24 00:08:46,381 - INFO - app.py:344 - 转录完成，结果: {
  "text": "這句話不夠流程",
  "segments": [
    {
      "id": 0,
      "seek": 0,
      "start": 1.02,
      "end": 5.48,
      "text": "這句話不夠流程",
      "tokens": [
        50364,
        2664,
        34592,
        11103,
        1960,
        31649,
        27854,
        29649,
        50614
      ],
      "temperature": 0.0,
      "avg_logprob": -0.49283013343811033,
      "compression_ratio": 0.65625,
      "no_speech_prob": 0.13431338965892792,
      "confidence": 0.79,
      "words": [
        {
          "text": "這",
          "start": 1.02,
          "end": 1.32,
          "confidence": 0.626
        },
        {
          "text": "句",
          "start": 1.32,
          "end": 2.36,
          "confidence": 0.782
        },
        {
          "text": "話",
          "start": 2.36,
          "end": 2.8,
          "confidence": 0.998
        },
        {
          "text": "不",
          "start": 2.8,
          "end": 4.02,
          "confidence": 0.826
        },
        {
          "text": "夠",
          "start": 4.02,
          "end": 4.88,
          "confidence": 0.972
        },
        {
          "text": "流",
          "start": 4.88,
          "end": 5.18,
          "confidence": 0.745
        },
        {
          "text": "程",
          "start": 5.18,
          "end": 5.48,
          "confidence": 0.659
        }
      ]
    }
  ],
  "language": "zh",
  "speech_activity": [
    {
      "start": 0.558,
      "end": 5.874
    }
  ]
}
2025-04-24 00:08:46,381 - INFO - app.py:347 - 开始处理转录结果...
2025-04-24 00:08:46,381 - INFO - app.py:350 - 处理段落: 這句話不夠流程
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 這
2025-04-24 00:08:46,381 - DEBUG - app.py:367 - 单词 這 到 句 的间隔: 0.000秒
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 句
2025-04-24 00:08:46,381 - DEBUG - app.py:367 - 单词 句 到 話 的间隔: 0.000秒
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 話
2025-04-24 00:08:46,381 - DEBUG - app.py:367 - 单词 話 到 不 的间隔: 0.000秒
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 不
2025-04-24 00:08:46,381 - DEBUG - app.py:367 - 单词 不 到 夠 的间隔: 0.000秒
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 夠
2025-04-24 00:08:46,381 - DEBUG - app.py:367 - 单词 夠 到 流 的间隔: 0.000秒
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 流
2025-04-24 00:08:46,381 - DEBUG - app.py:367 - 单词 流 到 程 的间隔: 0.000秒
2025-04-24 00:08:46,381 - DEBUG - app.py:353 - 处理单词: 程
2025-04-24 00:08:46,381 - INFO - app.py:380 - 开始分析间隔...
2025-04-24 00:08:46,381 - INFO - app.py:161 - 开始分析间隔...
2025-04-24 00:08:46,381 - INFO - app.py:165 - 处理段落 1/1: 這句話不夠流程
2025-04-24 00:08:46,381 - DEBUG - app.py:171 - 段落 1 包含 7 个词
2025-04-24 00:08:46,381 - DEBUG - app.py:178 - 拆分后的字符: ['這', '句', '話', '不', '夠', '流', '程']
2025-04-24 00:08:46,381 - DEBUG - app.py:182 - 处理字符 1/7: 這
2025-04-24 00:08:46,381 - DEBUG - app.py:192 - 找到包含字符 '這' 的词: 這
2025-04-24 00:08:46,382 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,382 - DEBUG - app.py:207 - 字符时间: 开始=1.020s, 结束=1.320s
2025-04-24 00:08:46,382 - DEBUG - app.py:226 - 找到下一个字符 '句' 的词: 句
2025-04-24 00:08:46,382 - DEBUG - app.py:239 - 字符 '這' 到 '句' 的间隔: 0.000秒
2025-04-24 00:08:46,382 - DEBUG - app.py:182 - 处理字符 2/7: 句
2025-04-24 00:08:46,382 - DEBUG - app.py:192 - 找到包含字符 '句' 的词: 句
2025-04-24 00:08:46,382 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,382 - DEBUG - app.py:207 - 字符时间: 开始=1.320s, 结束=2.360s
2025-04-24 00:08:46,382 - DEBUG - app.py:226 - 找到下一个字符 '話' 的词: 話
2025-04-24 00:08:46,382 - DEBUG - app.py:239 - 字符 '句' 到 '話' 的间隔: 0.000秒
2025-04-24 00:08:46,382 - DEBUG - app.py:182 - 处理字符 3/7: 話
2025-04-24 00:08:46,382 - DEBUG - app.py:192 - 找到包含字符 '話' 的词: 話
2025-04-24 00:08:46,382 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,382 - DEBUG - app.py:207 - 字符时间: 开始=2.360s, 结束=2.800s
2025-04-24 00:08:46,382 - DEBUG - app.py:226 - 找到下一个字符 '不' 的词: 不
2025-04-24 00:08:46,382 - DEBUG - app.py:239 - 字符 '話' 到 '不' 的间隔: 0.000秒
2025-04-24 00:08:46,382 - DEBUG - app.py:182 - 处理字符 4/7: 不
2025-04-24 00:08:46,382 - DEBUG - app.py:192 - 找到包含字符 '不' 的词: 不
2025-04-24 00:08:46,382 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,382 - DEBUG - app.py:207 - 字符时间: 开始=2.800s, 结束=4.020s
2025-04-24 00:08:46,382 - DEBUG - app.py:226 - 找到下一个字符 '夠' 的词: 夠
2025-04-24 00:08:46,382 - DEBUG - app.py:239 - 字符 '不' 到 '夠' 的间隔: 0.000秒
2025-04-24 00:08:46,382 - DEBUG - app.py:182 - 处理字符 5/7: 夠
2025-04-24 00:08:46,382 - DEBUG - app.py:192 - 找到包含字符 '夠' 的词: 夠
2025-04-24 00:08:46,382 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,382 - DEBUG - app.py:207 - 字符时间: 开始=4.020s, 结束=4.880s
2025-04-24 00:08:46,382 - DEBUG - app.py:226 - 找到下一个字符 '流' 的词: 流
2025-04-24 00:08:46,382 - DEBUG - app.py:239 - 字符 '夠' 到 '流' 的间隔: 0.000秒
2025-04-24 00:08:46,382 - DEBUG - app.py:182 - 处理字符 6/7: 流
2025-04-24 00:08:46,382 - DEBUG - app.py:192 - 找到包含字符 '流' 的词: 流
2025-04-24 00:08:46,382 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,383 - DEBUG - app.py:207 - 字符时间: 开始=4.880s, 结束=5.180s
2025-04-24 00:08:46,383 - DEBUG - app.py:226 - 找到下一个字符 '程' 的词: 程
2025-04-24 00:08:46,383 - DEBUG - app.py:239 - 字符 '流' 到 '程' 的间隔: 0.000秒
2025-04-24 00:08:46,383 - DEBUG - app.py:182 - 处理字符 7/7: 程
2025-04-24 00:08:46,383 - DEBUG - app.py:192 - 找到包含字符 '程' 的词: 程
2025-04-24 00:08:46,383 - DEBUG - app.py:196 - 字符位置: 1/1
2025-04-24 00:08:46,383 - DEBUG - app.py:207 - 字符时间: 开始=5.180s, 结束=5.480s
2025-04-24 00:08:46,383 - DEBUG - app.py:245 - 最后一个字符 '程' 没有后续间隔
2025-04-24 00:08:46,383 - INFO - app.py:254 - 段落 1 统计: 平均间隔=0.000秒, 标准差=0.000秒
2025-04-24 00:08:46,383 - INFO - app.py:267 - 间隔分析完成
2025-04-24 00:08:46,383 - INFO - app.py:382 - 间隔分析完成，结果: [
  {
    "text": "這句話不夠流程",
    "avg_interval": 0.0,
    "std_interval": 0.0,
    "word_details": [
      {
        "text": "這",
        "start": 1.02,
        "end": 1.32,
        "duration": 0.30000000000000004,
        "interval_to_next": 0.0
      },
      {
        "text": "句",
        "start": 1.32,
        "end": 2.36,
        "duration": 1.0399999999999998,
        "interval_to_next": 0.0
      },
      {
        "text": "話",
        "start": 2.36,
        "end": 2.8,
        "duration": 0.43999999999999995,
        "interval_to_next": 0.0
      },
      {
        "text": "不",
        "start": 2.8,
        "end": 4.02,
        "duration": 1.2199999999999998,
        "interval_to_next": 0.0
      },
      {
        "text": "夠",
        "start": 4.02,
        "end": 4.88,
        "duration": 0.8600000000000003,
        "interval_to_next": 0.0
      },
      {
        "text": "流",
        "start": 4.88,
        "end": 5.18,
        "duration": 0.2999999999999998,
        "interval_to_next": 0.0
      },
      {
        "text": "程",
        "start": 5.18,
        "end": 5.48,
        "duration": 0.3000000000000007,
        "interval_to_next": 0
      }
    ]
  }
]
2025-04-24 00:08:46,383 - INFO - app.py:402 - 临时文件已删除: /var/folders/m4/n1rfwfj14zsdfd39p1q2t77h0000gn/T/tmp52aomj_q.wav
2025-04-24 00:08:46,384 - INFO - _internal.py:225 - 127.0.0.1 - - [24/Apr/2025 00:08:46] "POST /upload HTTP/1.1" 200 -
